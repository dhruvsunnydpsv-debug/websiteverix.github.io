<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VELIX | Sovereign Apex</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #030712; 
            --panel: rgba(17, 24, 39, 0.95); 
            --accent: #6366f1; 
            --mentor: #10b981;
            --brutal: #ef4444;
            --text: #f8fafc; 
            --rainbow: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #8b00ff); 
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }

        /* CINEMATIC AURORA */
        .aurora { position: fixed; inset: 0; z-index: -1; background: radial-gradient(at 0% 0%, rgba(99,102,241,0.15) 0, transparent 50%), radial-gradient(at 100% 100%, rgba(236,72,153,0.15) 0, transparent 50%); background-image: radial-gradient(at 50% 50%, rgba(255,255,255,0.02) 0, transparent 50%); animation: pulse 8s infinite; }
        @keyframes pulse { 0% { opacity: 0.8; } 50% { opacity: 1; } 100% { opacity: 0.8; } }

        /* LOADING SCREEN */
        #loader { position: fixed; inset: 0; background: #020617; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s ease-out; }
        .loader-bar { width: 200px; height: 2px; background: rgba(255,255,255,0.1); margin-top: 20px; position: relative; overflow: hidden; }
        .loader-fill { position: absolute; top: 0; left: 0; height: 100%; width: 0%; background: var(--accent); transition: 2s ease-in-out; }
        .loader-text { font-size: 12px; font-weight: 800; letter-spacing: 4px; color: var(--accent); margin-bottom: 10px; }

        /* VISION OVERLAY */
        #vision-overlay { position: fixed; inset: 0; background: rgba(2, 6, 23, 0.98); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(10px); }
        .vision-card { width: 900px; background: #0f172a; border: 1px solid rgba(255,255,255,0.1); border-radius: 30px; padding: 50px; position: relative; box-shadow: 0 0 100px rgba(0,0,0,0.8); }
        .v-header { font-size: 48px; font-weight: 900; background: var(--rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; }
        .v-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px; }
        .v-item h3 { color: white; margin-bottom: 10px; font-size: 18px; }
        .v-item p { color: #94a3b8; font-size: 14px; line-height: 1.6; }

        /* SIDEBAR */
        .sidebar { width: 300px; background: var(--panel); border-right: 1px solid rgba(255,255,255,0.05); padding: 30px 20px; display: flex; flex-direction: column; backdrop-filter: blur(20px); }
        .logo { font-size: 26px; font-weight: 900; margin-bottom: 40px; color: white; letter-spacing: -1px; display: flex; align-items: center; gap: 10px; }
        .logo span { background: var(--rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .nav-cat { font-size: 10px; font-weight: 800; color: #475569; text-transform: uppercase; letter-spacing: 1px; margin: 20px 0 10px 10px; }
        .nav-btn { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid transparent; background: transparent; color: #94a3b8; text-align: left; font-weight: 700; cursor: pointer; margin-bottom: 4px; display: flex; align-items: center; gap: 12px; transition: 0.2s; }
        .nav-btn:hover { background: rgba(255,255,255,0.03); color: white; }
        .nav-btn.active { background: rgba(99, 102, 241, 0.1); color: white; border-color: var(--accent); }

        /* WORKSPACE */
        .workspace { flex: 1; display: flex; flex-direction: column; padding: 40px; position: relative; }
        
        /* DUAL MODE SWITCH */
        .mode-switch { background: rgba(255,255,255,0.03); border-radius: 100px; padding: 5px; display: flex; width: fit-content; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.1); }
        .mode-btn { padding: 10px 25px; border-radius: 100px; border: none; background: transparent; color: #94a3b8; font-weight: 800; cursor: pointer; transition: 0.3s; font-size: 12px; letter-spacing: 1px; text-transform: uppercase; }
        .mode-btn.active-brutal { background: var(--brutal); color: white; box-shadow: 0 0 20px rgba(239,68,68,0.4); }
        .mode-btn.active-mentor { background: var(--mentor); color: white; box-shadow: 0 0 20px rgba(16,185,129,0.4); }

        /* TOOLBARS */
        .toolbar { display: none; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; }
        .toolbar.active { display: flex; }
        input, select { background: #0f172a; border: 1px solid rgba(255,255,255,0.1); padding: 14px; border-radius: 12px; color: white; font-weight: 700; outline: none; font-size: 13px; flex: 1; min-width: 140px; }
        
        textarea { flex: 1; background: transparent; border: none; outline: none; color: white; font-size: 20px; font-weight: 500; line-height: 1.6; resize: none; margin-bottom: 20px; }
        
        /* ANALYTICS */
        .analytics { width: 440px; background: rgba(0,0,0,0.6); border-left: 1px solid rgba(255,255,255,0.1); padding: 40px; overflow-y: auto; display: flex; flex-direction: column; }
        .grade-box { text-align: center; margin-bottom: 30px; }
        .grade { font-size: 100px; font-weight: 900; line-height: 1; margin-bottom: 5px; background: var(--rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .result-card { background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.05); padding: 25px; border-radius: 20px; margin-bottom: 15px; }
        .rc-label { font-size: 10px; font-weight: 900; text-transform: uppercase; color: #64748b; margin-bottom: 10px; display: block; letter-spacing: 1px; }
        
        .btn-action { width: 100%; padding: 20px; border-radius: 16px; background: var(--accent); color: white; border: none; font-weight: 900; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; transition: 0.2s; font-size: 14px; }
        .btn-action:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(99,102,241,0.3); }

        /* VOICE */
        #voice-panel { display: none; gap: 15px; margin-bottom: 20px; }
        .v-stat { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 12px; flex: 1; text-align: center; }
        .v-val { font-size: 20px; font-weight: 900; color: white; }

        /* HISTORY */
        .hist-item { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 11px; color: #94a3b8; display: flex; justify-content: space-between; }
        .hist-grade { font-weight: 900; color: white; }
    </style>
</head>
<body>
    <div class="aurora"></div>

    <div id="loader">
        <div class="loader-text">INITIALIZING VELIX CORE</div>
        <div class="loader-bar"><div class="loader-fill" id="l-fill"></div></div>
    </div>

    <div id="vision-overlay">
        <div class="vision-card">
            <h1 class="v-header">VELIX SOVEREIGN</h1>
            <p style="font-size: 18px; color: #cbd5e1; margin-bottom: 30px;">The definitive A.I. audit engine. Choose your path: <b>Brutal Truth</b> for relentless critique, or <b>Mentor</b> for strategic growth.</p>
            
            <div class="v-grid">
                <div class="v-item">
                    <h3>‚öîÔ∏è Brutal Truth</h3>
                    <p>Zero empathy. Logic flaws are destroyed. Grades are strict. Best for stress-testing ideas.</p>
                </div>
                <div class="v-item">
                    <h3>üåø Mentor Mode</h3>
                    <p>Constructive analysis. Focuses on potential and actionable steps. Best for improvement.</p>
                </div>
            </div>
            <button class="btn-action" style="margin-top: 40px;" onclick="closeVision()">ENTER COMMAND</button>
        </div>
    </div>

    <aside class="sidebar">
        <div class="logo">VELIX <span>APEX</span></div>
        
        <div class="nav-cat">Creation Engine</div>
        <button class="nav-btn active" id="nav-gen" onclick="setTab('gen')">‚ö° Generator</button>
        <button class="nav-btn" id="nav-text" onclick="setTab('text')">üìù Writing Audit</button>
        <button class="nav-btn" id="nav-voice" onclick="setTab('voice')">üéôÔ∏è Voice Lab</button>
        
        <div class="nav-cat">Specialized</div>
        <button class="nav-btn" id="nav-art" onclick="setTab('art')">üé® Art Audit</button>
        <button class="nav-btn" id="nav-arc" onclick="setTab('arc')">üöÄ Architect</button>

        <div style="margin-top: auto; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 16px;">
            <div class="nav-cat" style="margin-top:0">Session History</div>
            <div id="history-log" style="max-height: 150px; overflow-y: auto;"></div>
        </div>
    </aside>

    <main class="workspace">
        <div class="mode-switch">
            <button class="mode-btn active-brutal" id="m-brutal" onclick="setMode('brutal')">‚öîÔ∏è Brutal Truth</button>
            <button class="mode-btn" id="m-mentor" onclick="setMode('mentor')">üåø Mentor</button>
        </div>

        <div id="tool-gen" class="toolbar active">
            <input id="g-topic" placeholder="Topic / Niche">
            <input id="g-tone" placeholder="Tone (e.g. Viral)">
            <select id="g-format"><option>LinkedIn Post</option><option>Twitter Thread</option><option>Blog Intro</option></select>
            <input id="g-hook" placeholder="Viral Hook (Optional)">
        </div>

        <div id="tool-text" class="toolbar">
            <select id="t-focus"><option>Logic & Flow</option><option>Grammar & Syntax</option><option>Persuasion</option></select>
            <input id="t-aud" placeholder="Target Audience">
            <input id="t-read" type="number" placeholder="Grade Level (1-12)" style="max-width: 120px;">
        </div>

        <div id="voice-panel">
            <div class="v-stat"><div class="v-val" id="wpm">0</div><div style="font-size:10px; color:#94a3b8">WPM</div></div>
            <div class="v-stat"><div class="v-val" id="dur">00:00</div><div style="font-size:10px; color:#94a3b8">TIME</div></div>
            <button onclick="toggleRec()" style="flex:2; background:#ef4444; border:none; color:white; border-radius:12px; font-weight:800; cursor:pointer;">üî¥ REC / STOP</button>
        </div>

        <div id="tool-art" class="toolbar">
            <input id="a-style" placeholder="Style (e.g. Bauhaus)">
            <select id="a-comp"><option>Rule of Thirds</option><option>Golden Ratio</option><option>Symmetry</option></select>
            <input id="a-color" placeholder="Palette (e.g. Neon)">
        </div>

        <div id="tool-arc" class="toolbar">
            <input id="arc-goal" placeholder="Project Goal">
            <select id="arc-res"><option>Low Budget</option><option>Unlimited</option></select>
            <input id="arc-risk" type="range" min="1" max="10" title="Risk Level">
        </div>

        <textarea id="main-input" placeholder="Awaiting raw data..."></textarea>
        
        <button class="btn-action" onclick="ignite()" id="action-btn">INITIATE ANALYSIS</button>
    </main>

    <aside class="analytics">
        <div class="grade-box">
            <div class="rc-label">SOVEREIGN GRADE</div>
            <div class="grade" id="grade">--</div>
        </div>

        <div class="result-card" id="card-feedback" style="border-left: 4px solid #ef4444;">
            <span class="rc-label" id="lbl-feedback">THE KILLSHOT</span>
            <p id="txt-feedback" style="font-size: 18px; font-weight: 700; color: white;">Awaiting audit.</p>
        </div>

        <div class="result-card">
            <span class="rc-label">AI ENHANCED VERSION</span>
            <p id="txt-enhance" style="font-size: 14px; color: #cbd5e1; line-height: 1.6;">No data.</p>
            <button onclick="playAudio()" style="margin-top:15px; background:rgba(255,255,255,0.1); border:none; color:white; padding:10px; width:100%; border-radius:10px; font-weight:700; cursor:pointer;">üîä PLAY AUDIO</button>
        </div>
    </aside>

    <script>
        const KEY = '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';
        let state = { tab: 'gen', mode: 'brutal' };
        let recognition, timer, startTime;

        // LOAD SEQUENCE
        window.onload = () => {
            document.getElementById('l-fill').style.width = '100%';
            setTimeout(() => {
                document.getElementById('loader').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loader').style.display = 'none';
                    document.getElementById('vision-overlay').style.display = 'flex';
                }, 800);
            }, 1500);
        };

        function closeVision() { document.getElementById('vision-overlay').style.display = 'none'; }

        function setTab(t) {
            state.tab = t;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.toggle('active', b.id.includes(t)));
            document.querySelectorAll('.toolbar').forEach(b => b.classList.toggle('active', b.id.includes(t)));
            document.getElementById('voice-panel').style.display = t === 'voice' ? 'flex' : 'none';
            document.getElementById('main-input').value = "";
        }

        function setMode(m) {
            state.mode = m;
            document.getElementById('m-brutal').className = `mode-btn ${m==='brutal'?'active-brutal':''}`;
            document.getElementById('m-mentor').className = `mode-btn ${m==='mentor'?'active-mentor':''}`;
            
            // UI Update based on mode
            const color = m === 'brutal' ? '#ef4444' : '#10b981';
            document.getElementById('card-feedback').style.borderLeftColor = color;
            document.getElementById('lbl-feedback').innerText = m === 'brutal' ? "THE KILLSHOT" : "GROWTH PATH";
            document.getElementById('lbl-feedback').style.color = color;
        }

        // VOICE LOGIC
        function toggleRec() {
            if(!recognition) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.continuous = true;
                recognition.onresult = e => {
                    const txt = e.results[e.results.length-1][0].transcript;
                    document.getElementById('main-input').value += txt + " ";
                    const wpm = Math.round(document.getElementById('main-input').value.split(' ').length / ((new Date() - startTime)/60000));
                    document.getElementById('wpm').innerText = wpm || 0;
                };
            }
            if(timer) {
                recognition.stop();
                clearInterval(timer);
                timer = null;
            } else {
                recognition.start();
                startTime = new Date();
                timer = setInterval(() => {
                    const diff = Math.floor((new Date() - startTime)/1000);
                    const m = Math.floor(diff/60).toString().padStart(2,'0');
                    const s = (diff%60).toString().padStart(2,'0');
                    document.getElementById('dur').innerText = `${m}:${s}`;
                }, 1000);
            }
        }

        async function ignite() {
            const btn = document.getElementById('action-btn');
            const input = document.getElementById('main-input').value;
            if(!input) return;

            btn.innerText = state.mode === 'brutal' ? "DESTROYING WEAKNESS..." : "ANALYZING POTENTIAL...";
            btn.style.background = state.mode === 'brutal' ? "#ef4444" : "#10b981";

            const prompt = state.mode === 'brutal' 
                ? "You are VELIX. Be aggressive, mean, and strictly logical. Roast the user. JSON ONLY: {\"grade\": \"S-F\", \"feedback\": \"1 sentence roast\", \"enhance\": \"Superior version\"}"
                : "You are VELIX MENTOR. Be constructive, helpful, and kind. Focus on growth. JSON ONLY: {\"grade\": \"S-F\", \"feedback\": \"1 sentence advice\", \"enhance\": \"Improved version\"}";

            try {
                const r = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: 'POST',
                    headers: {'Authorization': `Bearer ${KEY}`, 'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        model: "google/gemini-2.0-flash-001",
                        messages: [{role: "system", content: prompt}, {role: "user", content: input}],
                        response_format: { type: "json_object" }
                    })
                });
                const d = await r.json();
                const res = JSON.parse(d.choices[0].message.content);

                document.getElementById('grade').innerText = res.grade;
                document.getElementById('txt-feedback').innerText = res.feedback;
                document.getElementById('txt-enhance').innerText = res.enhance;

                const logItem = document.createElement('div');
                logItem.className = 'hist-item';
                logItem.innerHTML = `<span>${new Date().toLocaleTimeString()}</span><span class="hist-grade" style="color:${state.mode==='brutal'?'#ef4444':'#10b981'}">${res.grade}</span>`;
                document.getElementById('history-log').prepend(logItem);

            } catch(e) { console.error(e); }
            btn.innerText = "INITIATE ANALYSIS";
            btn.style.background = "#6366f1";
        }

        function playAudio() {
            const u = new SpeechSynthesisUtterance(document.getElementById('txt-enhance').innerText);
            window.speechSynthesis.speak(u);
        }
    </script>
</body>
</html>
